<!DOCTYPE html>
<html>
	<head>
		<title>Lab 4 Test</title>
		<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.js'></script>
		<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.css' rel='stylesheet' />
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
		<meta charset="utf-8" />
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
   integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
   crossorigin=""/>
	</head>
	 <title>About Me</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
   integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
   crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
   integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
   crossorigin=""></script>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="Leaflet.markercluster-master/dist/MarkerCluster.css"/>
  <link rel="stylesheet" href="Leaflet.markercluster-master/dist/MarkerCluster.Default.css"/>
  <script src="Leaflet.markercluster-master/dist/leaflet.markercluster-src.js"></script>
  </head>
  <body class="right-sidebar is-preload">
    <div id="page-wrapper">

      <!-- Header -->
        <div id="header">

          <!-- Inner -->
             <div class="inner"><d<header>
                <h1><a href="index.html" id="logo">Karen Zeeb</a></h1>
                <p>Lab 4 â€¢ 2 Maps on a page with realtime geojson</p>
              </header>
            </div>

          <!-- Nav -->
            <nav id="nav">
              <ul>
                <li><a href="index.html">Home</a></li>
                <li>
                  <a href="#">Portfolios</a>
                  <ul>
                    <li><a href="https://www.slideshare.net/KarenZeeb1/zeeb-carto-portfolio-2018">Cartography</a></li>
                    <li><a href="https://www.slideshare.net/KarenZeeb1/zeeb-design-portfolio-2018">Design</a></li>
                    <li><a href="http://karen.zzzeeb.com/paintings.html">Painting</a></li>
                    
                  </ul>
                </li>
                <li><a href="about-me.html">About Me</a></li>
                <li><a href="MSGT.html">MSGT Labs</a></li>
                <li><a href="mailto:kzeeb@uw.edu">Contact</a></li>
              </ul>
            </nav>

        </div>
	  <p></p>
	<body>
		<!-- the div for the map -->
		<!-- note the style is in-line, we have been putting it in the header. Outcome is the same -->
		<div id='map' style='width: 100%; height: 400px;'></div>
		<!-- the script that controls the map -->
		<script>
			//my Mapbox token
			mapboxgl.accessToken = 'pk.eyJ1Ijoia3plZWIiLCJhIjoiY2l1NXFvZTQ1MGh5eTJ6bGgwZzMzb2xhcyJ9.cKBxgvZoWhW-oGe6cQI4Kw';
			
			//The map variable
			var map = new mapboxgl.Map({
			    container: 'map',
			    style: 'mapbox://styles/kzeeb/cjo7ciqb1254t2smro47yyty0',
			});
			//set the center & zoom of the map
			map.setCenter([-85, 44]);
			map.setZoom(3);

			//on map load, do some stuff
			map.on('load', function(){
				//add a source layer for earthquakes
				map.addSource('earthquakes', {
			        "type": "geojson",
			        "data": "https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_week.geojson"
			    });
			    //add the earthquakes to the map
			    map.addLayer({
			    	"id":"equakes",
			    	"type":"circle",
				"source":"earthquakes",
				"paint": {
					'circle-color': {
					property:'mag',
					stops: [
					[2, '#f46b0f'],
					[5, '#0b6f95'],
					[7, '#7f2200'],
					[10, '#f40fdf']
					]
					},
				 // Add data-driven styles for circle radius
					 'circle-radius': {
					 property: 'mag',
					 type: 'exponential',
					 stops: [
					[2, 3],
					[4, 5],
					[6, 7],
					[8, 8],
					[10, 12]
					]
     				 	}
				}		
						
	 });				
 });

				//add a handler for clicking/popups 
				//Thanks to: https://www.mapbox.com/mapbox-gl-js/example/popup-on-click/ 
				map.on('click', 'equakes', function (e) {
			        var coordinates = e.features[0].geometry.coordinates.slice();
			        //print the properties to the console when clicked
			        console.log(e.features[0].properties);
			        //THE HTML ELEMENT THAT WILL GO IN THE POPUP
			        var description = "<p>Mag: " + e.features[0].properties.mag 
				+ "<br>Location: " + e.features[0].properties.place 
				+ "<br>Link: "+"<a href='"+e.features[0].properties.url+"'>Click here</a></p>";
			        //var description = e.features[0].properties.mag;


			        // Ensure that if the map is zoomed out such that multiple
			        // copies of the feature are visible, the popup appears
			        // over the copy being pointed to.
			        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
			            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
			        }
			        //make the popup
			        new mapboxgl.Popup()
			            .setLngLat(coordinates)
			            .setHTML(description)
			            .addTo(map);
 });
		</script>
			<p></p>
				
		<div id='map2' style='width: 100%; height: 400px;'></div>
      <script>

  //my Mapbox token
			mapboxgl.accessToken = 'pk.eyJ1Ijoia3plZWIiLCJhIjoiY2l1NXFvZTQ1MGh5eTJ6bGgwZzMzb2xhcyJ9.cKBxgvZoWhW-oGe6cQI4Kw';
			
			//The map variable
			var map2 = new mapboxgl.Map({
			    container: 'map2',
			    style: 'mapbox://styles/kzeeb/cjokfogz701402sp3fhqec8r5',
			});
			//set the center & zoom of the map
			map2.setCenter([-85, 44]);
			map2.setZoom(3);

			//on map load, do some stuff
			map2.on('load', function(){
				//add a source layer for earthquakes
				map2.addSource('seattlerds', {
			        "type": "geojson",
			        "data": "https://data.seattle.gov/api/views/q773-8un5/rows.json?accessType=DOWNLOAD"
			    });
			    //add the earthquakes to the map
			    map2.addLayer({
			    	"id":"equakes",
			    	"type":"circle",
				"source":"earthquakes",
				"paint": {
					'circle-color': {
					property:'mag',
					stops: [
					[2, '#f46b0f'],
					[5, '#0b6f95'],
					[7, '#7f2200'],
					[10, '#f40fdf']
					]
					},
				 // Add data-driven styles for circle radius
					 'circle-radius': {
					 property: 'mag',
					 type: 'exponential',
					 stops: [
					[2, 3],
					[4, 5],
					[6, 7],
					[8, 8],
					[10, 12]
					]
     				 	}
				}		
						
	 });				
 });

				//add a handler for clicking/popups 
				//Thanks to: https://www.mapbox.com/mapbox-gl-js/example/popup-on-click/ 
				map2.on('click', 'equakes', function (e) {
			        var coordinates = e.features[0].geometry.coordinates.slice();
			        //print the properties to the console when clicked
			        console.log(e.features[0].properties);
			        //THE HTML ELEMENT THAT WILL GO IN THE POPUP
			        var description = "<p>Mag: " + e.features[0].properties.mag 
				+ "<br>Location: " + e.features[0].properties.place 
				+ "<br>Link: "+"<a href='"+e.features[0].properties.url+"'>Click here</a></p>";
			        //var description = e.features[0].properties.mag;


			        // Ensure that if the map is zoomed out such that multiple
			        // copies of the feature are visible, the popup appears
			        // over the copy being pointed to.
			        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
			            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
			        }
			        //make the popup
			        new mapboxgl.Popup()
			            .setLngLat(coordinates)
			            .setHTML(description)
			            .addTo(map2);
 });
		</script>
	</body>
</html>
